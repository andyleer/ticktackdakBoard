<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tic Tac Toe</title>
  <style>
    :root {
      --bg: #0b0c10;
      --surface: #15171e;
      --surface-2: #1b1e27;
      --text: #f1f5f9;
      --muted: #cbd5e1;
      --accent: #60a5fa;
      --accent-2: #34d399;
      --grid-line: #2a2f3a;
      --win: rgba(52, 211, 153, 0.35);
      --radius: 18px;
      --shadow: 0 12px 30px rgba(0,0,0,.35);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: var(--bg);
      color: var(--text);
      display: grid;
      place-items: center;
    }

    .app {
      width: min(94vw, 560px);
      padding: 18px;
      background: var(--surface);
      border: 1px solid #202430;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    .header, .toolbar { display: flex; align-items: center; justify-content: space-between; gap: 10px; }
    h1 { margin: 0; font-size: 22px; letter-spacing: .2px; }
    .status { color: var(--muted); font-weight: 600; }

    .select-players { text-align: center; }
    .select-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin: 12px 0 8px; }
    .select-card { background: var(--surface-2); border: 1px solid #232735; border-radius: 14px; padding: 10px; }
    .select-card button { all: unset; cursor: pointer; display: grid; place-items: center; }
    .avatar { width: 72px; height: 72px; object-fit: contain; display: block; margin: 6px auto 6px; }
    .label { font-size: 13px; color: var(--muted); }
    .select-card.selected { outline: 2px solid var(--accent-2); }

    .button {
      background: #1f2431; border: 1px solid #2a2f3a; color: var(--text);
      padding: 10px 14px; border-radius: 12px; cursor: pointer; font-weight: 700;
    }
    .button.primary { background: #1e293b; border-color: #334155; }
    .button.ghost { background: transparent; border-color: #2a2f3a; }
    .button:disabled { opacity: .5; cursor: not-allowed; }

    .board-wrap { background: var(--surface-2); border: 1px solid #232735; border-radius: 14px; padding: 10px; }
    .board { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; width: 100%; aspect-ratio: 1 / 1; background: var(--grid-line); }
    .cell { position: relative; border-radius: 12px; background: #0f1117; border: 1px solid #2a2f3a; display: flex; align-items: center; justify-content: center; cursor: pointer; aspect-ratio: 1 / 1; overflow: hidden; }
    .cell img { width: 76%; height: 76%; object-fit: contain; display: block; }
    .cell.win::after { content: ""; position: absolute; inset: 0; background: var(--win); pointer-events: none; }
    .cell.disabled { pointer-events: none; }

    .scores { color: var(--muted); font-size: 14px; }
    .scores strong { color: var(--text); }

    .stack { display: grid; gap: 10px; }
    .row { display: flex; gap: 8px; align-items: center; justify-content: space-between; }
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="Tic Tac Toe">
    <div class="header">
      <h1>üéÆ Tic Tac Toe</h1>
      <div class="status" id="status">Select two players</div>
    </div>

    <div id="selectScreen" class="select-players">
      <p style="margin:6px 0 4px;color:var(--muted)">Tap two avatars to choose players or play classic X and O.</p>
      <div id="characterList" class="select-grid"></div>
      <div class="row" style="justify-content:center; margin-top:6px;">
        <button id="startGameBtn" class="button primary" disabled>Start Game</button>
      </div>
      <div class="row" style="justify-content:center; margin-top:10px;">
        <button id="classicModeBtn" class="button">Play Classic X / O</button>
      </div>
    </div>

    <div id="gameScreen" style="display:none;" class="stack">
      <div class="row">
        <div class="status">Turn: <strong id="turnMark"></strong></div>
        <div class="row" style="gap:6px;">
          <button id="backBtn" class="button ghost">‚Üê Players</button>
          <button id="newGameBtn" class="button">New Round</button>
        </div>
      </div>
      <div class="board-wrap">
        <div class="board" id="board" aria-label="Game board" role="grid"></div>
      </div>
      <div class="toolbar">
        <div class="scores">P1 (<span id="p1Name">?</span>): <strong id="score1">0</strong> ‚Ä¢ P2 (<span id="p2Name">?</span>): <strong id="score2">0</strong> ‚Ä¢ Draws: <strong id="scoreD">0</strong></div>
      </div>
    </div>
  </div>

  <script>
    const characters = ['andy','guy','courey','dorothy','grandmon','pappy'];
    let selected = [];
    let players = {p1:null,p2:null};
    let board = Array(9).fill(null);
    let playerTurn = 'p1';
    let scores = {p1:0,p2:0,D:0};
    let gameOver = false;
    let classicMode = false;

    const selectScreen = document.getElementById('selectScreen');
    const characterList = document.getElementById('characterList');
    const startGameBtn = document.getElementById('startGameBtn');
    const gameScreen = document.getElementById('gameScreen');
    const boardEl = document.getElementById('board');
    const turnMarkEl = document.getElementById('turnMark');
    const score1El = document.getElementById('score1');
    const score2El = document.getElementById('score2');
    const scoreDEl = document.getElementById('scoreD');
    const newGameBtn = document.getElementById('newGameBtn');
    const backBtn = document.getElementById('backBtn');
    const p1NameEl = document.getElementById('p1Name');
    const p2NameEl = document.getElementById('p2Name');
    const statusEl = document.getElementById('status');
    const classicModeBtn = document.getElementById('classicModeBtn');

    characters.forEach(name => {
      const card = document.createElement('div');
      card.className = 'select-card';
      const btn = document.createElement('button');
      const img = document.createElement('img');
      img.src = `${name}.png`; img.alt = name; img.className = 'avatar';
      const label = document.createElement('div'); label.className = 'label'; label.textContent = cap(name);
      btn.appendChild(img); btn.appendChild(label);
      btn.addEventListener('click', () => toggleSelect(name, card));
      card.appendChild(btn);
      characterList.appendChild(card);
    });

    function toggleSelect(name, card){
      if(selected.includes(name)){
        selected = selected.filter(n => n !== name);
        card.classList.remove('selected');
      } else if(selected.length < 2){
        selected.push(name);
        card.classList.add('selected');
      }
      startGameBtn.disabled = selected.length !== 2;
    }

    startGameBtn.addEventListener('click', () => {
      classicMode = false;
      players.p1 = selected[0];
      players.p2 = selected[1];
      p1NameEl.textContent = cap(players.p1);
      p2NameEl.textContent = cap(players.p2);
      statusEl.textContent = 'Game on!';
      showGame();
      startRound();
    });

    classicModeBtn.addEventListener('click', () => {
      classicMode = true;
      players.p1 = 'X';
      players.p2 = 'O';
      p1NameEl.textContent = 'X';
      p2NameEl.textContent = 'O';
      statusEl.textContent = 'Classic Mode';
      showGame();
      startRound();
    });

    backBtn.addEventListener('click', () => {
      hideGame();
      statusEl.textContent = 'Select two players';
    });

    function showGame(){ selectScreen.style.display = 'none'; gameScreen.style.display = 'grid'; }
    function hideGame(){ gameScreen.style.display = 'none'; selectScreen.style.display = 'block'; }

    function startRound(){
      board = Array(9).fill(null);
      playerTurn = 'p1';
      gameOver = false;
      turnMarkEl.textContent = players[playerTurn];
      boardEl.innerHTML = '';
      for(let i=0;i<9;i++){
        const cell = document.createElement('button');
        cell.className = 'cell';
        cell.dataset.idx = i;
        cell.addEventListener('click', onCellClick);
        boardEl.appendChild(cell);
      }
    }

    function onCellClick(e){
      if(gameOver) return;
      const idx = Number(e.currentTarget.dataset.idx);
      if(board[idx]) return;
      board[idx] = players[playerTurn];
      if(classicMode){
        e.currentTarget.textContent = players[playerTurn];
        e.currentTarget.style.fontSize = '48px';
        e.currentTarget.style.fontWeight = 'bold';
      } else {
        const img = document.createElement('img');
        img.src = `${players[playerTurn]}.png`;
        e.currentTarget.appendChild(img);
      }
      const win = checkWin();
      if(win){
        win.forEach(i => boardEl.children[i].classList.add('win'));
        scores[playerTurn]++;
        gameOver = true;
      } else if(board.every(Boolean)){
        scores.D++; gameOver = true;
      } else {
        playerTurn = playerTurn==='p1' ? 'p2' : 'p1';
      }
      updateScores();
      turnMarkEl.textContent = players[playerTurn];
    }

    function checkWin(){
      const WINS = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
      for(const [a,b,c] of WINS){
        if(board[a] && board[a]===board[b] && board[a]===board[c]) return [a,b,c];
      }
      return null;
    }

    function updateScores(){
      score1El.textContent = scores.p1;
      score2El.textContent = scores.p2;
      scoreDEl.textContent = scores.D;
    }

    function cap(s){ return s.charAt(0).toUpperCase() + s.slice(1); }
  </script>
</body>
</html>
